<!doctype html>
/[if lt IE 7]
  <html class='no-js lt-ie9 lt-ie8 lt-ie7' lang='en'>
/[if IE 7]
  <html class='no-js lt-ie9 lt-ie8' lang='en'>
/[if IE 8]
  <html class='no-js lt-ie9' lang='en'>
/ Consider adding a manifest.appcache: h5bp.com/d/Offline
/[if gt IE 8] ><!
%html.no-js{:lang => 'en'}
  / <![endif]
  %head
    = display_meta_tags :site => 'Ideal Me'
    %meta{:content => 'width=1300', :name => 'viewport'}/
    = stylesheet_link_tag 'application', :media => 'all'
    = javascript_include_tag 'https://js.stripe.com/v2/', 'application'
    = csrf_meta_tags
    %link{:href => 'http://fonts.googleapis.com/css?family=Open+Sans', :rel => 'stylesheet', :type => 'text/css'}/
    = tinymce :content_css => asset_path('application.css')
    = favicon_link_tag 'apple-touch-icon-144-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '144x144'
    = favicon_link_tag 'apple-touch-icon-114-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '114x114'
    = favicon_link_tag 'apple-touch-icon-72-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png', :sizes => '72x72'
    = favicon_link_tag 'apple-touch-icon-precomposed.png', :rel => 'apple-touch-icon-precomposed', :type => 'image/png'
  %body{:class => body_class}
    = image_tag('staging-banner.png', :class=>'staging-banner') if Rails.env.staging? || Rails.env.development?
    %header      
      .header-content
        - if current_user
          .user-box
            =image_tag current_user.avatar(:thumb), :class => 'user-avatar'
            %ul.user-menu
              %li
                = link_to 'Settings', user_edit_path(current_user)
              %li                                                 
                = link_to 'Notifications', user_edit_path(current_user)
              %li                                                 
                = link_to 'Find friends', user_edit_path(current_user)
              %li                                                 
                = link_to 'Archived goals', archived_goals_path
              %li                                                 
                = link_to 'Give feedback', feedbacks_path                
              - if can? :access, :admin
                %li
                  = link_to 'Admin', admin_root_path
              %li.sign-out
                = link_to 'Sign out', destroy_user_session_path
          %ul.left-menu
            %li
              = link_to 'DISCOVER', discovers_path, :class => active_tab?('discovers', params[:controller])
            %li
              = link_to 'MARKETPLACE', markets_path, :class => active_tab?('markets', params[:controller])
            %li
              = link_to 'ME', user_path(current_user), :class => active_tab?('users', params[:controller])
          = form_tag(searches_path, :method => 'get', :class => 'search-box') do
            .input-append
              = text_field_tag('q', @search, :class => 'search-field', :placeholder => 'Search goals, gems, courses, people')                                                                                              
              %button.btn{:type => 'submit'}   
                %i.icon-search            
          .logo.logged-in
            = link_to('', root_path, :title => 'Ideal Me')
          .clear
        - else
          .container
            .fb-social-box
              .fb-like{'data-href' => 'http://www.idealme.com', 'data-layout' => 'button_count', 'data-send' => 'false', 'data-show-faces' => 'false', 'data-width' => '450'}
            .sign-in-box
              = link_to 'Sign in', new_user_session_path, :class => 'btn'
            .logo
              = link_to('', root_path)
    %section.body_content.body-content
      - if flash[:alert]
        .alert.alert-error
          = flash[:alert]
      - if flash[:notice]
        .alert.alert-success
          = flash[:notice]
      - c = params[:controller].split('/')
      - if c.length == 2 && ['dashboard', 'admin', 'support'].include?(c.first)
        .container{:style => 'background:#ffffff; padding:10px;min-height:900px'}
          %div{:style=>'margin:10px'}
            = link_to 'Dashboard', admin_root_path, :class => 'btn btn-mini'
            = link_to 'Markets', admin_markets_path, :class => 'btn btn-mini'
            = link_to 'Courses', admin_courses_path, :class => 'btn btn-mini'
            = link_to 'Sections', admin_sections_path, :class => 'btn btn-mini'
            = link_to 'Lectures', admin_lectures_path, :class => 'btn btn-mini'
            = link_to 'Users', admin_users_path, :class => 'btn btn-mini'
            = link_to 'Goals', admin_goals_path, :class => 'btn btn-mini'
            = link_to 'Categories', admin_categories_path, :class => 'btn btn-mini'
            = link_to 'Polls', admin_polls_path, :class => 'btn btn-mini'
            = link_to 'Articles', admin_articles_path, :class => 'btn btn-mini'
            = link_to 'Feedbacks', admin_feedbacks_path, :class => 'btn btn-mini'
            = link_to 'Gems', admin_gems_path, :class => 'btn btn-mini'
            = link_to 'CMS', cms_admin_path, :class => 'btn btn-mini'  
            %hr
            = yield
      - else
        = yield
    %footer
      .container                
        %a{:href => '/static/about', :class => 'footer-menu', :style => 'border-right: 1px solid black;'} About
                                                                   
        %a{:href => '/static/about', :class => 'footer-menu'} About
        %a{:href => '#', :class => 'footer-menu'} Epic Challenge
        %a{:href => '/static/terms-of-services', :class => 'footer-menu'} Terms
        %a{:href => '/static/privacy-policy', :class => 'footer-menu'} Privacy
        %a{:href => '/static/customer-care', :class => 'footer-menu'} Customer Care  
        %a{:href => '/static/about', :class=>'footer-menu'} 
          &copy; 
          = Time.now.year 
          Ideal Me
    = get_friendly_affiliate_tracking
    #fb-root
    :javascript
      (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = '//connect.facebook.net/en_US/all.js#xfbml=1&appId=122762434513312';
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));  
      var idealme = "you";#{include_gon(:namespace => "im_js", :need_tag => false)}